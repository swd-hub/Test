<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¸‚å ´ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ï¼ˆé †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ï¼šç·åˆè¨ˆåŸºæº–ï¼‰</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>
    :root {
        --primary-color: #007bff;
        --secondary-color: #6c757d;
        --background-color: #f8f9fa;
        --container-bg: #ffffff;
        --shadow-color: rgba(0,0,0,0.1);
        --header-bg: #343a40;
        --table-header-bg: #e9ecef;
        --positive-color: #28a745; /* ç·‘ */
        --negative-color: #dc3545; /* èµ¤ */
        --zero-color: #6c757d; /* ã‚°ãƒ¬ãƒ¼ */
    }

    body { 
        font-family: 'Noto Sans JP', sans-serif; 
        padding: 20px; 
        background-color: var(--background-color); 
        color: #212529; 
    }

    .container { 
        max-width: 1400px; 
        margin: 0 auto; 
        background: var(--container-bg); 
        padding: 25px; 
        border-radius: 10px; 
        box-shadow: 0 4px 12px var(--shadow-color); 
    }

    /* --- ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒœã‚¿ãƒ³ --- */
    .header-top { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
        padding-bottom: 15px;
        border-bottom: 3px solid #dee2e6;
    }

    h1 { 
        font-size: 1.6rem; 
        margin: 0; 
        flex-grow: 1; 
        color: var(--header-bg);
    }
    
    #sourceButton {
        padding: 10px 20px;
        background-color: var(--secondary-color);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 700;
        font-size: 14px;
        text-decoration: none;
        display: inline-block;
        transition: background-color 0.3s;
    }
    #sourceButton:hover { background-color: #5a6268; }

    /* --- å…¥åŠ›ã‚¨ãƒªã‚¢ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« --- */
    .input-area { margin-bottom: 30px; }
    textarea { 
        width: 100%; 
        height: 180px; 
        padding: 15px; 
        border: 1px solid #ced4da; 
        border-radius: 6px; 
        font-family: monospace; 
        font-size: 12px;
        resize: vertical;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }

    .controls { 
        margin-top: 15px; 
        display: flex; 
        gap: 20px; 
        align-items: center; 
        background: #e9f2ff; /* æ·¡ã„ãƒ–ãƒ«ãƒ¼ */
        padding: 15px; 
        border-radius: 6px; 
        flex-wrap: wrap; 
        border: 1px solid #cce5ff;
    }

    label { font-weight: 600; }

    input[type="number"] { 
        padding: 8px; 
        border: 1px solid #ced4da; 
        border-radius: 4px; 
        font-size: 14px; 
        width: 70px; 
        text-align: center;
    }

    #errorMessage { 
        color: var(--negative-color); 
        font-weight: bold; 
        margin-top: 15px; 
        font-size: 1rem;
    }

    .score-note { 
        font-size: 0.95rem; 
        color: #5a6268; 
        margin-bottom: 20px; 
        padding: 10px;
        border-left: 4px solid var(--primary-color);
        background-color: #f1f8ff;
    }

    /* --- ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ --- */
    .tables-container { display: flex; flex-direction: column; gap: 40px; }
    
    .gender-section h2 { 
        background-color: var(--primary-color); 
        color: white; 
        padding: 12px 15px; 
        margin: 0; 
        font-size: 1.2rem; 
        border-radius: 6px 6px 0 0; 
        margin-top: 20px;
    }
    
    table { 
        width: 100%; 
        border-collapse: collapse; 
        font-size: 13px; 
        background: white; 
        border: 1px solid #dee2e6;
        border-radius: 0 0 6px 6px;
        overflow: hidden; /* è§’ä¸¸ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã«å¿…è¦ */
    }

    th, td { 
        border: 1px solid #e9ecef; 
        padding: 10px; 
        text-align: center; 
    }

    th { 
        background-color: var(--table-header-bg); 
        color: #343a40; 
        font-weight: 700; 
        cursor: pointer;
        user-select: none;
        position: relative;
        vertical-align: middle;
        line-height: 1.3;
    }
    th:hover { background-color: #d7dce0; }

    th.sort-asc::after { content: " â–²"; color: var(--primary-color); font-size: 1.2em; }
    th.sort-desc::after { content: " â–¼"; color: var(--primary-color); font-size: 1.2em; }

    tr:nth-child(even) { background-color: #fcfcfc; }
    tr:hover:not(.total-row) { background-color: #f1f1f1; }

    .market-name-col { text-align: left; font-weight: 600; color: #000; }
    .total-row { background-color: #ffeeba !important; font-weight: 700; border-top: 2px solid #ffc107; }
    .total-row td { background-color: inherit; }

    /* ã‚¹ã‚³ã‚¢è¡¨ç¤º */
    .count-rank { 
        font-weight: bold; 
        font-size: 1.1em; 
        color: #000; 
    }

    .score-rank-diff { 
        font-weight: 700; 
        font-size: 1.2em;
        display: block;
    }
    /* é †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ã®è‰²åˆ†ã‘ */
    .rank-positive { color: var(--positive-color); } /* ãƒ—ãƒ©ã‚¹ï¼ˆå¸‚å ´ãŒç·åˆè¨ˆã‚ˆã‚Šé †ä½ãŒè‰¯ã„/é«˜ã„ï¼‰ -> ç·‘ */
    .rank-negative { color: var(--negative-color); } /* ãƒã‚¤ãƒŠã‚¹ï¼ˆå¸‚å ´ãŒç·åˆè¨ˆã‚ˆã‚Šé †ä½ãŒæ‚ªã„/ä½ã„ï¼‰ -> èµ¤ */
    .rank-zero { color: var(--zero-color); } /* ã‚¼ãƒ­ */
</style>
</head>
<body>

<div class="container">
    <div class="header-top">
        <h1>ğŸ“Š å¸‚å ´ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ï¼ˆé †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ï¼šç·åˆè¨ˆåŸºæº–ï¼‰</h1>
        <a id="sourceButton" href="https://www.alic.go.jp/operation/livestock/calf-report.html" target="_blank">è‚‰ç”¨å­ç‰›å–å¼•æƒ…å ±ã‚µã‚¤ãƒˆã¸</a>
    </div>

    <p class="score-note">
        **ã€ãƒ„ãƒ¼ãƒ«ã®èª¬æ˜ã€‘**<br>
        â€» **ãƒ‡ãƒ¼ã‚¿è²¼ã‚Šä»˜ã‘**ã‚„**æŠ½å‡ºå¹´æœˆ**ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€**è‡ªå‹•ã§è¡¨ãŒæ›´æ–°**ã•ã‚Œã¾ã™ã€‚<br>
        â€» **çœŒåˆè¨ˆã®ãƒ‡ãƒ¼ã‚¿**ã¯é™¤å¤–ã—ã¦ã‚ã‚Šã¾ã™ã€‚<br>
        â€» **å–å¼•é ­æ•°**ã¯ã€**å®Ÿæ•°ï¼ˆé ­ï¼‰**ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ï¼ˆã‚½ãƒ¼ãƒˆæ™‚ï¼šé ­æ•°ãŒå°‘ãªã„é †/å¤šã„é †ï¼‰<br>
        â€» **ãã®ä»–ï¼ˆä¾¡æ ¼ã€ä½“é‡ã€æ—¥é½¢ã€å˜ä¾¡ï¼‰**ã¯ã€**æ•°å€¤ãŒå¤§ãã„å¸‚å ´ãŒ1ä½**ã¨ãªã‚‹é †ä½ã§è¨ˆç®—ã•ã‚Œã€ç·åˆè¨ˆé †ä½ã¨ã®**å·®åˆ†ï¼ˆé †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ï¼‰**ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚<br>
        &nbsp;&nbsp;&nbsp;&nbsp;ä¾‹: é †ä½å·®ãŒ**<span class="rank-positive">+3</span>**ãªã‚‰ã€å¸‚å ´ã¯ç·åˆè¨ˆã‚ˆã‚Š**3ãƒ©ãƒ³ã‚¯è‰¯ã„**ï¼ˆé †ä½ãŒé«˜ã„ï¼‰ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚<br>
        &nbsp;&nbsp;&nbsp;&nbsp;ä¾‹: é †ä½å·®ãŒ**<span class="rank-negative">-3</span>**ãªã‚‰ã€å¸‚å ´ã¯ç·åˆè¨ˆã‚ˆã‚Š**3ãƒ©ãƒ³ã‚¯æ‚ªã„**ï¼ˆé †ä½ãŒä½ã„ï¼‰ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚
    </p>

    <div class="input-area">
        <textarea id="dataInput" placeholder="ã“ã“ã«Excelã‚„PDFã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„..."></textarea>
        <div class="controls">
            <label>æŠ½å‡ºå¯¾è±¡å¹´: <input type="number" id="targetYear" placeholder="ä¾‹: 2025"></label>
            <label>æŠ½å‡ºå¯¾è±¡æœˆ: <input type="number" id="targetMonth" placeholder="ä¾‹: 8"></label>
        </div>
        <div id="errorMessage"></div>
    </div>

    <div id="resultArea" class="tables-container"></div>
</div>

<script>
// ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®šç¾©ã¨åˆæœŸåŒ–
let parsedDataByGender = { 'é›„': [], 'é›Œ': [], 'è¨ˆ': [] };
let marketMap = {};
let sortState = {
    'é›„': { key: null, dir: 'asc' },
    'é›Œ': { key: null, dir: 'asc' },
    'è¨ˆ': { key: null, dir: 'asc' }
};
let debounceTimer; // ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†ç”¨ã‚¿ã‚¤ãƒãƒ¼

const metricsMap = [
    { key: 'count', label: 'å–å¼•é ­æ•°', unit: 'é ­' },
    { key: 'price', label: 'å¹³å‡ä¾¡æ ¼', unit: 'å††' },
    { key: 'weight', label: 'å¹³å‡ä½“é‡', unit: 'kg' },
    { key: 'age', label: 'å¹³å‡æ—¥é½¢', unit: 'æ—¥' },
    { key: 'unitPrice', label: '1kgå˜ä¾¡', unit: 'å††' }
];

// éƒ½é“åºœçœŒåã®ãƒªã‚¹ãƒˆï¼ˆå¸‚å ´åã¨åˆ¤åˆ¥ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ï¼‰
const PREF_NAMES = ["åŒ—æµ·é“", "é’æ£®", "å²©æ‰‹", "å®®åŸ", "ç§‹ç”°", "å±±å½¢", "ç¦å³¶", "èŒ¨åŸ", "æ ƒæœ¨", "ç¾¤é¦¬", "åŸ¼ç‰", "åƒè‘‰", "æ±äº¬", "ç¥å¥ˆå·", "æ–°æ½Ÿ", "å¯Œå±±", "çŸ³å·", "ç¦äº•", "å±±æ¢¨", "é•·é‡", "å²é˜œ", "é™å²¡", "æ„›çŸ¥", "ä¸‰é‡", "æ»‹è³€", "äº¬éƒ½", "å¤§é˜ª", "å…µåº«", "å¥ˆè‰¯", "å’Œæ­Œå±±", "é³¥å–", "å³¶æ ¹", "å²¡å±±", "åºƒå³¶", "å±±å£", "å¾³å³¶", "é¦™å·", "æ„›åª›", "é«˜çŸ¥", "ç¦å²¡", "ä½è³€", "é•·å´", "ç†Šæœ¬", "å¤§åˆ†", "å®®å´", "é¹¿å…å³¶", "æ²–ç¸„"];

/**
 * å¸‚å ´åã‚’å«ã‚€è¡Œã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹
 * @param {string} line - ã‚¿ãƒ–åŒºåˆ‡ã‚Šã®ãƒ‡ãƒ¼ã‚¿è¡Œ
 * @returns {boolean}
 */
function isMarketHeaderLine(line) {
    if (line.includes("ãƒšãƒ¼ã‚¸") || line.includes("æœˆåˆ¥è‚‰ç”¨å­ç‰›å–å¼•çŠ¶æ³è¡¨") || line.includes("ç·åˆè¨ˆ") || line.includes("å“ç¨®ï¼š")) return false;

    const parts = line.split(/\t/).map(p => p.trim()).filter(p => p.length > 0);
    
    if (parts.length > 0) {
        const firstPart = parts[0];
        // æœ€åˆã®è¦ç´ ãŒéƒ½é“åºœçœŒåã€ã¾ãŸã¯ãã®ä¸€éƒ¨ã‚’å«ã¿ã€ã‹ã¤å¸‚å ´åãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹
        if (PREF_NAMES.some(p => firstPart === p || (firstPart.length > 2 && firstPart.includes(p.substring(0, 2))))) {
            return true;
        }
    }
    
    return false;
}

/**
 * éƒ½é“åºœçœŒã¨å¸‚å ´åã‚’åˆ†é›¢ã—ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è¿”ã™
 * @param {string} line - ã‚¿ãƒ–åŒºåˆ‡ã‚Šã®ãƒ‡ãƒ¼ã‚¿è¡Œ (ã¾ãŸã¯çµåˆã•ã‚ŒãŸã‚­ãƒ¼)
 * @returns {{prefecture: string, market: string}}
 */
function extractPrefAndMarket(line) {
    let parts = line.split(/\t/).map(p => p.trim()).filter(p => p.length > 0);
    
    if (parts.length < 2) {
        const rawName = parts[0] || '';
        if (PREF_NAMES.includes(rawName)) return { prefecture: rawName, market: '' };
        return { prefecture: rawName, market: '' }; 
    }

    const prefecture = parts[0].replace(/ï¼Š|\*|ï¼|-/g, "").trim();
    let market = parts[1].replace(/ï¼Š|\*|ï¼|-/g, "").trim();
    
    return { prefecture: prefecture, market: market };
}

/**
 * å¸‚å ´åã‹ã‚‰ä¸€æ„ã®ã‚­ãƒ¼ã‚’ç”Ÿæˆ
 * @param {string} pref - éƒ½é“åºœçœŒå
 * @param {string} market - å¸‚å ´å
 * @returns {string}
 */
function createMarketKey(pref, market) {
    if (pref === 'ç·åˆè¨ˆ' || (pref === 'ç·åˆè¨ˆ' && market === '')) return 'ç·åˆè¨ˆ';
    return `${pref}_${market}`;
}


/**
 * ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºã¨æ ¼ç´ï¼ˆå‹ã®å³å¯†åŒ–ï¼‰
 * @param {string[]} lineParts - è¡Œã‚’ã‚¿ãƒ–ã§åˆ†å‰²ã—ãŸé…åˆ—
 * @param {number} dataStartIndexInLine - å¯¾è±¡æœˆã®ãƒ‡ãƒ¼ã‚¿ãŒå§‹ã¾ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
 * @param {string} marketName - å¸‚å ´ã‚­ãƒ¼
 * @param {('é›„'|'é›Œ'|'è¨ˆ')} gender - æ€§åˆ¥
 * @param {string} metricKey - ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚­ãƒ¼ (count, price, etc.)
 */
function extractAndStore(lineParts, dataStartIndexInLine, marketName, gender, metricKey) {
    const raw = lineParts[dataStartIndexInLine];

    if (raw === undefined || raw === null || raw === '') {
        return;
    }
    
    let cleaned = raw.replace(/,/g, '').replace(/[N\/A\*ï¼]/g, '').trim(); 

    if (cleaned === '') {
        return;
    }

    const num = parseFloat(cleaned);
    
    if (!isNaN(num)) {
        if (!marketMap[marketName][gender]) marketMap[marketName][gender] = {};
        marketMap[marketName][gender][metricKey] = num;
    }
}


/**
 * è²¼ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã€è¡¨ã‚’ç”Ÿæˆã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
 */
function processData() {
    const text = document.getElementById('dataInput').value;
    const targetMonth = document.getElementById('targetMonth').value.trim(); 
    const errorDiv = document.getElementById('errorMessage');
    const resultDiv = document.getElementById('resultArea');
    
    errorDiv.textContent = "";
    resultDiv.innerHTML = "";
    parsedDataByGender = { 'é›„': [], 'é›Œ': [], 'è¨ˆ': [] };
    marketMap = {};
    sortState = { // ã‚½ãƒ¼ãƒˆçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        'é›„': { key: null, dir: 'asc' },
        'é›Œ': { key: null, dir: 'asc' },
        'è¨ˆ': { key: null, dir: 'asc' }
    };

    if (!text) {
        errorDiv.textContent = "ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚";
        return;
    }
    if (!targetMonth || isNaN(parseInt(targetMonth))) {
        errorDiv.textContent = "æœ‰åŠ¹ãªæŠ½å‡ºå¯¾è±¡æœˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
        return;
    }

    const lines = text.split('\n').map(line => line.trim()).filter(line => line.length > 0);
    
    // 1. ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’æ¢ã—ã¦å¯¾è±¡æœˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç‰¹å®š
    let monthIndex = -1;
    let headerLineIndex = -1;

    for (let i = 0; i < lines.length; i++) {
        // éƒ½é“åºœçœŒ, å¸‚å ´å, æœˆã‚’å«ã‚€è¡Œã‚’æ¢ã™
        if (lines[i].includes('éƒ½é“åºœçœŒ') && lines[i].includes('å¸‚å ´å') && (lines[i].includes('æœˆ') || lines[i].includes('12æœˆ'))) {
            headerLineIndex = i;
            break;
        }
    }

    if (headerLineIndex === -1) {
        errorDiv.textContent = "ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆéƒ½é“åºœçœŒ, å¸‚å ´å, æœˆã‚’å«ã‚€è¡Œï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚";
        return;
    }

    const headerParts = lines[headerLineIndex].split(/\t/).map(p => p.trim()).filter(p => p.length > 0);

    for (let i = 0; i < headerParts.length; i++) {
        // '8æœˆ' -> '8' ã«ã—ã¦æ¯”è¼ƒ
        const part = headerParts[i].replace(/æœˆ/g, '').replace(/\s/g, ''); 
        if (part === targetMonth) {
            monthIndex = i;
            break;
        }
    }
    
    if (monthIndex === -1) {
        errorDiv.textContent = `å¯¾è±¡æœˆï¼ˆ${targetMonth}æœˆï¼‰ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ¼ã‚¿åˆ—ã¯${headerParts.slice(2).join(', ')}ã§ã™ã€‚`;
        return;
    }
    
    // éƒ½é“åºœçœŒã¨å¸‚å ´åãŒæœ€åˆã®2åˆ—ã«ã‚ã‚‹ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã¯ monthIndex ã§ã¯ãªãã€ãã®åˆ—ã®ä½ç½®ã‹ã‚‰å–å¾—
    const dataStartIndexInLine = monthIndex; 
    
    // 2. ãƒ‡ãƒ¼ã‚¿è§£æ
    let currentMarketKey = null;
    let currentPrefName = null;
    let currentMarketName = null;
    let currentMetric = null;

    for (let i = headerLineIndex + 1; i < lines.length; i++) {
        const line = lines[i];
        
        // ä¸è¦ãªè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
        if (line.includes("ãƒšãƒ¼ã‚¸ï¼š") || line.includes("ã€Š") || line.includes("å“ç¨®ï¼š") || line.includes("å–å¼•æœˆ")) continue;

        // å¸‚å ´å/ç·åˆè¨ˆã®åˆ‡ã‚Šæ›¿ãˆ
        const isTotalLine = line.includes("ç·åˆè¨ˆ") && !line.includes("åˆè¨ˆãƒ»å¹³å‡");
        let isMarketLine = isMarketHeaderLine(line);

        if (isTotalLine || isMarketLine) {
            if (isTotalLine) {
                currentPrefName = 'ç·åˆè¨ˆ';
                currentMarketName = '';
                currentMarketKey = 'ç·åˆè¨ˆ';
            } else {
                const names = extractPrefAndMarket(line);
                currentPrefName = names.prefecture;
                currentMarketName = names.market;
                currentMarketKey = createMarketKey(currentPrefName, currentMarketName);
            }
            
            // çœŒåˆè¨ˆã¯é™¤å¤–
            if (currentMarketName.includes("çœŒåˆè¨ˆ")) {
                currentMarketKey = null; // ç„¡åŠ¹åŒ–
                continue;
            }

            if (!marketMap[currentMarketKey]) {
                marketMap[currentMarketKey] = { 'é›„': {}, 'é›Œ': {}, 'è¨ˆ': {} };
            }
            currentMetric = null; // å¸‚å ´ãŒå¤‰ã‚ã£ãŸã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¯ãƒªã‚»ãƒƒãƒˆ
            continue;
        }

        if (!currentMarketKey) continue; // å¸‚å ´åãŒç‰¹å®šã•ã‚Œã¦ã„ãªã„è¡Œã¯ã‚¹ã‚­ãƒƒãƒ—

        // æŒ‡æ¨™ï¼ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼‰ã®åˆ‡ã‚Šæ›¿ãˆæ¤œå‡º
        let metricChanged = false;
        if (line.includes("å–å¼•é ­æ•°")) { currentMetric = "count"; metricChanged = true; }
        else if (line.includes("å¹³å‡ä¾¡æ ¼")) { currentMetric = "price"; metricChanged = true; }
        else if (line.includes("å¹³å‡ä½“é‡")) { currentMetric = "weight"; metricChanged = true; }
        else if (line.includes("å¹³å‡æ—¥é½¢")) { currentMetric = "age"; metricChanged = true; }
        else if (line.includes("ï¼‘ãå˜ä¾¡") || line.includes("1kgå˜ä¾¡")) { currentMetric = "unitPrice"; metricChanged = true; }
        
        if (!currentMetric) continue;

        // ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºãƒ­ã‚¸ãƒƒã‚¯
        const lineParts = line.split(/\t/).map(p => p.trim());
        
        const hasFemale = line.includes("é›Œ");
        const hasMale = line.includes("é›„");
        
        // ãƒ‡ãƒ¼ã‚¿ã®è¡Œã‚’åˆ¤å®š
        const isCountTotalLine = currentMetric === 'count' && (line.includes("è¨ˆ") || line.includes("åˆè¨ˆ")) && !line.includes("åˆè¨ˆãƒ»å¹³å‡");
        const isMetricAverageLine = currentMetric !== 'count' && (line.includes("è¨ˆ") || line.includes("å¹³å‡")) && !line.includes("åˆè¨ˆãƒ»å¹³å‡");

        if (hasFemale) {
            extractAndStore(lineParts, dataStartIndexInLine, currentMarketKey, 'é›Œ', currentMetric);
        }
        if (hasMale) {
            extractAndStore(lineParts, dataStartIndexInLine, currentMarketKey, 'é›„', currentMetric);
        }
        if (isCountTotalLine || isMetricAverageLine) {
            extractAndStore(lineParts, dataStartIndexInLine, currentMarketKey, 'è¨ˆ', currentMetric);
        }
    }

    // 3. ãƒãƒƒãƒ—ã‹ã‚‰é…åˆ—ã¸å¤‰æ›ã—ã€ã‚¹ã‚³ã‚¢ã‚’æº–å‚™
    Object.keys(marketMap).forEach(mKey => {
        
        const nameParts = mKey === 'ç·åˆè¨ˆ' ? { prefecture: 'ç·åˆè¨ˆ', market: '' } : extractPrefAndMarket(mKey.replace('_', '\t'));
        
        ['é›„', 'é›Œ', 'è¨ˆ'].forEach(g => {
            let obj = { 
                key: mKey,
                prefecture: nameParts.prefecture,
                market: nameParts.market,
                genderName: g 
            };
            let hasData = false;
            metricsMap.forEach(m => {
                const v = marketMap[mKey][g][m.key];
                obj[m.key] = v !== undefined ? v : null;
                
                // count ã®ã‚¹ã‚³ã‚¢ã¯å®Ÿæ•°ã€ä»–ã¯é †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ã‚’æ ¼ç´ã™ã‚‹å ´æ‰€ã‚’æº–å‚™
                obj[`${m.key}Score`] = (m.key === 'count' && v !== undefined) ? v : null; 
                
                if (v !== undefined && v !== null && v !== 0) hasData = true;
            });

            // ç·åˆè¨ˆã¾ãŸã¯æœ‰åŠ¹ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹è¡Œã®ã¿ã‚’ä¿æŒ
            if (hasData || mKey === 'ç·åˆè¨ˆ') {
                parsedDataByGender[g].push(obj);
            }
        });
    });
    
    // ãƒ‡ãƒ¼ã‚¿ãŒãªã„æ€§åˆ¥ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    ['é›„', 'é›Œ', 'è¨ˆ'].forEach(g => {
        parsedDataByGender[g] = parsedDataByGender[g].filter(row => 
            row.key === 'ç·åˆè¨ˆ' || metricsMap.some(m => row[m.key] !== null && row[m.key] !== 0)
        );
    });

    if (parsedDataByGender['è¨ˆ'].length === 0 && parsedDataByGender['é›„'].length === 0 && parsedDataByGender['é›Œ'].length === 0) {
        errorDiv.textContent = "æœ‰åŠ¹ãªå¸‚å ´ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚å¯¾è±¡æœˆã®åˆ—ã¨ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚";
        return;
    }

    calculateScores();    
    renderTables();
}

/**
 * ç·åˆè¨ˆé †ä½ã¨ã®å·®åˆ†ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã€ãƒ‡ãƒ¼ã‚¿ã«æ ¼ç´ã™ã‚‹
 */
function calculateScores() {
    ['é›„', 'é›Œ', 'è¨ˆ'].forEach(gender => {
        const data = parsedDataByGender[gender];
        if (!data || data.length === 0) return;
        
        metricsMap.forEach(m => {
            const metricKey = m.key;
            
            // å–å¼•é ­æ•°('count')ã¯å®Ÿæ•°è¡¨ç¤ºã®ãŸã‚ã€é †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ã®è¨ˆç®—ã‚’ã‚¹ã‚­ãƒƒãƒ—
            if (metricKey === 'count') {
                return; 
            }

            const totalRow = data.find(row => row.key === 'ç·åˆè¨ˆ');
            const allRows = data; 
            
            const totalValue = totalRow ? totalRow[metricKey] : null;

            // ä¾¡æ ¼ã€ä½“é‡ãªã©: æ•°å€¤ãŒå¤§ãã„æ–¹ãŒ1ä½ (é™é †)
            const sortFunction = (a, b) => b - a; 

            // æœ‰åŠ¹ãªå€¤ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã€ã‚½ãƒ¼ãƒˆ
            const validValues = allRows
                .map(r => r[metricKey])
                .filter(v => v !== null && v !== 0 && !isNaN(v))
                .sort(sortFunction); 
            
            // å€¤ã¨ãã®é †ä½ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°
            const valueToRankAll = {};
            let currentRank = 1; 
            
            for (let i = 0; i < validValues.length; i++) {
                const val = validValues[i];
                if (valueToRankAll[val] === undefined) {
                    valueToRankAll[val] = currentRank;
                }
                
                // æ¬¡ã®å€¤ãŒç•°ãªã‚‹ã‹ã€é…åˆ—ã®æœ«å°¾ã§ã‚ã‚Œã°ã€æ¬¡ã®ãƒ©ãƒ³ã‚¯ã‚’è¨­å®š
                if (i + 1 < validValues.length && validValues[i + 1] !== val) {
                    currentRank = i + 2; 
                }
            }

            const totalRank = (totalValue !== null && totalValue !== 0) ? valueToRankAll[totalValue] : null;

            allRows.forEach(row => {
                const val = row[metricKey];
                
                if (row.key === 'ç·åˆè¨ˆ') {
                    row[`${metricKey}Score`] = '-'; 
                } else if (val == null || val === 0 || isNaN(val)) {
                    row[`${metricKey}Score`] = null; 
                } else {
                    const marketRank = valueToRankAll[val];
                    if (marketRank) {
                        if (totalRank === null) {
                            row[`${metricKey}Score`] = null; 
                        } else {
                            // é †ä½å·®åˆ†ã‚¹ã‚³ã‚¢: ç·åˆè¨ˆé †ä½ - å¸‚å ´é †ä½
                            // +ã«ãªã‚‹ã»ã©å¸‚å ´ã®é †ä½ãŒè‰¯ã„
                            const rankDiff = totalRank - marketRank;
                            row[`${metricKey}Score`] = rankDiff;
                        }
                    } else {
                        row[`${metricKey}Score`] = null;
                    }
                }
            });
        });
    });
}

/**
 * ã‚¹ã‚³ã‚¢å€¤ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã€HTMLã‚¿ã‚°ã‚’ä»˜ä¸ã™ã‚‹
 * @param {string|number} score - ã‚¹ã‚³ã‚¢å€¤ã¾ãŸã¯å®Ÿæ•°
 * @param {string} key - ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚­ãƒ¼
 * @returns {string} - HTMLã‚¿ã‚°ä»˜ãã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿æ–‡å­—åˆ—
 */
function formatScoreValue(score, key) {
    if (score === undefined || score === null || score === '-') return `-`;
    
    if (key === 'count') {
        // å–å¼•é ­æ•°ã¯å®Ÿæ•°ã‚’è¡¨ç¤ºã—ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã«ã™ã‚‹
        const num = Math.round(parseFloat(score));
        if (isNaN(num)) return score;
        return `<span class="count-rank">${num.toLocaleString()}</span>`;
    }
    
    // ä»–ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆé †ä½å·®åˆ†ã‚¹ã‚³ã‚¢ï¼‰ã®å‡¦ç†
    const num = parseFloat(score);
    if (isNaN(num)) return score;
    
    const formatted = num > 0 ? `+${num}` : `${num}`;
    const scoreClass = num > 0 ? "rank-positive" : num < 0 ? "rank-negative" : "rank-zero";
    return `<span class="score-rank-diff ${scoreClass}">${formatted}</span>`;
}

/**
 * ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹
 * @param {('é›„'|'é›Œ'|'è¨ˆ')} gender - æ€§åˆ¥
 * @param {string} key - ã‚½ãƒ¼ãƒˆã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚­ãƒ¼ (ã¾ãŸã¯ 'prefecture', 'market')
 */
function sortTable(gender, key) {
    const data = parsedDataByGender[gender].filter(row => row.key !== 'ç·åˆè¨ˆ');
    const totalRow = parsedDataByGender[gender].find(row => row.key === 'ç·åˆè¨ˆ');

    // ã‚½ãƒ¼ãƒˆæ–¹å‘ã®åˆ‡ã‚Šæ›¿ãˆ
    if (sortState[gender].key === key) {
        sortState[gender].dir = sortState[gender].dir === 'asc' ? 'desc' : 'asc';
    } else {
        sortState[gender].key = key;
        
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚½ãƒ¼ãƒˆæ–¹å‘ã‚’è¨­å®š
        if (key === 'prefecture' || key === 'market' || key === 'count') {
            sortState[gender].dir = 'asc'; // åœ°åã€é ­æ•°ã¯æ˜‡é †
        } else {
            sortState[gender].dir = 'desc'; // ã‚¹ã‚³ã‚¢ã¯é™é †ï¼ˆè‰¯ã„é †ï¼‰
        }
    }
    const dir = sortState[gender].dir;

    data.sort((a, b) => {
        if (key === 'prefecture' || key === 'market') {
            const comp = a[key].localeCompare(b[key], 'ja');
            return dir === 'asc' ? comp : -comp;
        }
        
        // ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ã‚’è¨­å®š (countã®å ´åˆã¯å®Ÿæ•°ã€ä»–ã¯é †ä½å·®åˆ†ã‚¹ã‚³ã‚¢)
        const sortKey = key === 'count' ? 'countScore' : `${key}Score`; 
        const valA = a[sortKey];
        const valB = b[sortKey];

        const isInvalidA = (valA === null || valA === undefined || valA === '-');
        const isInvalidB = (valB === null || valB === undefined || valB === '-');

        if (isInvalidA && isInvalidB) return 0;
        if (isInvalidA) return 1; 
        if (isInvalidB) return -1; 

        // æ•°å€¤æ¯”è¼ƒ
        return dir === 'asc' ? valA - valB : valB - valA;
    });

    // ç·åˆè¨ˆè¡Œã‚’é…åˆ—ã®æœ«å°¾ã«æˆ»ã™
    parsedDataByGender[gender] = totalRow ? [...data, totalRow] : data;
    renderTables();
}

/**
 * ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’HTMLã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
 */
function renderTables() {
    const container = document.getElementById('resultArea');
    container.innerHTML = "";
    
    ['é›„', 'é›Œ', 'è¨ˆ'].forEach(g => {
        const data = parsedDataByGender[g];
        if (data.length === 0) return;

        const section = document.createElement('div');
        section.className = 'gender-section';
        
        let title = `ã€${g}ã€‘ å¸‚å ´ãƒ‡ãƒ¼ã‚¿ä¸€è¦§`;
        if (g === 'è¨ˆ') {
             const hasCountData = data.some(row => row.countScore !== null && row.countScore !== '-');
             const hasOtherData = data.some(row => metricsMap.filter(m => m.key !== 'count').some(m => row[`${m.key}Score`] !== null && row[`${m.key}Score`] !== '-'));
             
             if (hasCountData && hasOtherData) {
                 title = `ã€è¨ˆï¼ˆé ­æ•°ï¼‰/å¹³å‡ï¼ˆä¾¡æ ¼ãªã©ï¼‰ã€‘ å¸‚å ´ãƒ‡ãƒ¼ã‚¿ä¸€è¦§`;
             } else if (hasOtherData) {
                 title = `ã€å¹³å‡ã€‘ å¸‚å ´ãƒ‡ãƒ¼ã‚¿ä¸€è¦§`;
             } else if (hasCountData) {
                 title = `ã€è¨ˆã€‘ å¸‚å ´ãƒ‡ãƒ¼ã‚¿ä¸€è¦§`;
             }
        }
        
        let html = `<h2>${title}</h2>
        <table>
            <thead>
                <tr>
                    <th onclick="sortTable('${g}', 'prefecture')" class="${sortState[g].key === 'prefecture' ? 'sort-' + sortState[g].dir : ''}">éƒ½é“åºœçœŒ</th>
                    <th onclick="sortTable('${g}', 'market')" class="${sortState[g].key === 'market' ? 'sort-' + sortState[g].dir : ''}">å¸‚å ´å</th>`;
        metricsMap.forEach(m => {
            let headerLabel;
            const rankLabel = 'ï¼ˆé †ä½å·®åˆ†ï¼‰';
            
            if (m.key === 'count') {
                headerLabel = `${m.label}<br>ï¼ˆå®Ÿæ•°ï¼šé ­ï¼‰`;
                if (g === 'è¨ˆ') headerLabel = `å–å¼•é ­æ•°ï¼ˆè¨ˆï¼‰<br>ï¼ˆå®Ÿæ•°ï¼šé ­ï¼‰`;
            } else {
                headerLabel = `${m.label}<br>${rankLabel}`;
                if (g === 'è¨ˆ') headerLabel = `${m.label}ï¼ˆå¹³å‡ï¼‰<br>${rankLabel}`;
            }

            const isSorted = sortState[g].key === m.key;
            const sortClass = isSorted ? 'sort-' + sortState[g].dir : '';
            html += `<th onclick="sortTable('${g}', '${m.key}')" class="${sortClass}">${headerLabel}</th>`;
        });
        html += `</tr></thead><tbody>`;
        
        data.forEach(row => {
            const isTotal = row.key === 'ç·åˆè¨ˆ';
            const rowClass = isTotal ? 'class="total-row"' : '';
            
            // ç·åˆè¨ˆã®å ´åˆã¯1ã‚»ãƒ«çµåˆã—ã¦è¡¨ç¤º
            const prefDisplay = isTotal ? `<td class="market-name-col" colspan="2">ç·åˆè¨ˆ</td>` : 
                                         `<td class="market-name-col">${row.prefecture}</td><td class="market-name-col">${row.market}</td>`;
            
            html += `<tr ${rowClass}>${prefDisplay}`;
            
            metricsMap.forEach(m => {
                const displayValue = formatScoreValue(row[`${m.key}Score`], m.key);
                html += `<td>${displayValue}</td>`;
            });
            html += `</tr>`;
        });
        html += `</tbody></table>`;
        section.innerHTML = html;
        container.appendChild(section);
    });
}

/**
 * ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†ä»˜ãã§ processData ã‚’å®Ÿè¡Œ
 */
function debounceProcessData() {
    clearTimeout(debounceTimer);
    // ãƒ‡ãƒ¼ã‚¿å…¥åŠ›å¾Œã«å³åº§ã«å‡¦ç†ãŒèµ°ã‚‹ã®ã‚’é˜²ããŸã‚ã€300msã®é…å»¶ã‚’è¨­å®š
    debounceTimer = setTimeout(processData, 300); 
}


// åˆæœŸãƒ‡ãƒ¼ã‚¿è¨­å®šã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
window.onload = function() {
    const dataInput = document.getElementById('dataInput');
    const targetYear = document.getElementById('targetYear');
    const targetMonth = document.getElementById('targetMonth');
    
    // 1. æœ¬æ—¥ã®å¹´æœˆã‚’å–å¾—
    const now = new Date();
    // UTCã‹ã‚‰JSTã¸å¤‰æ› (JST=UTC+9)ã€‚ç¾åœ¨ã®å®Ÿè¡Œç’°å¢ƒã®æ™‚åˆ»ã‚’æ­£ç¢ºã«åæ˜ ã•ã›ã¾ã™ã€‚
    const jstOffset = 9 * 60; 
    const nowJST = new Date(now.getTime() + (now.getTimezoneOffset() * 60000) + (jstOffset * 60000));
    
    const currentYear = nowJST.getFullYear();
    const currentMonth = nowJST.getMonth() + 1; // getMonth()ã¯0ã‹ã‚‰å§‹ã¾ã‚‹ãŸã‚+1

    // 2. æŠ½å‡ºå¯¾è±¡ã®å¹´æœˆã«æœ¬æ—¥ã®å¹´æœˆã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼ˆä¿®æ­£ç‚¹ï¼‰
    targetYear.value = currentYear;
    targetMonth.value = currentMonth;


    // 3. è²¼ã‚Šä»˜ã‘ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸå€¤
    // (ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ãŒã€å‹•ä½œç¢ºèªã®ãŸã‚å…ƒã€…ã®ãƒ‡ãƒ¼ã‚¿ä¾‹ã‚’æ®‹ã—ã¾ã™)
    dataInput.value = `éƒ½é“åºœçœŒ	å¸‚å ´å	12æœˆ	1æœˆ	2æœˆ	3æœˆ	4æœˆ	5æœˆ	6æœˆ	7æœˆ	8æœˆ	9æœˆ	10æœˆ	11æœˆ	åˆè¨ˆãƒ»å¹³å‡
åŒ—æµ·é“	ãƒ›ã‚¯ãƒ¬ãƒ³å—åŒ—æµ·é“å®¶ç•œå¸‚å ´
	å–å¼•é ­æ•°
	ï¼ˆé ­ï¼‰	é›Œ	785	563	676	625	688	718	690	681	597	604	585	601	7028
		é›„	944	805	902	789	940	1060	929	812	794	881	842	865	9619
		è¨ˆ	1729	1368	1578	1414	1628	1778	1619	1493	1391	1485	1427	1466	16647
	å¹³å‡ä¾¡æ ¼
	ï¼ˆå††ï¼‰	é›Œ	476069	525605	547652	580108	677015	629563	595819	646333	664295	609425	633152	674834	617306
		é›„	600128	656085	683328	722827	805909	745047	747471	777784	778781	751776	753167	793066	747367
		è¨ˆ	543803	602386	625206	659744	751438	698412	682838	717826	729645	693877	703967	744596	692458
	å¹³å‡ä½“é‡
	ï¼ˆKgï¼‰	é›Œ	312	316	314	311	317	317	318	314	311	314	314	320	315
		é›„	331	336	335	334	342	341	342	340	334	340	339	345	339
		è¨ˆ	322	328	326	324	331	332	331	328	324	330	329	335	329
	å¹³å‡æ—¥é½¢
	ï¼ˆæ—¥ï¼‰	é›Œ	301	308	308	306	309	307	304	305	302	306	303	309	306
		é›„	290	296	297	296	298	296	295	292	291	295	293	297	295
		è¨ˆ	295	301	302	301	303	300	299	298	295	299	297	302	300
	ï¼‘ãå˜ä¾¡
	ï¼ˆå††ï¼‰	é›Œ	1526	1661	1747	1864	2139	1983	1876	2059	2137	1939	2014	2110	1959
		é›„	1813	1953	2038	2165	2355	2183	2189	2285	2331	2211	2220	2298	2203
		è¨ˆ	1687	1837	1918	2037	2268	2106	2061	2186	2251	2105	2139	2224	2105
ç·åˆè¨ˆ
	å–å¼•é ­æ•°
	ï¼ˆé ­ï¼‰	é›Œ	7000	6000	5000	4000	3000	2000	1000	500	400	300	200	100	30600
		é›„	9000	8000	7000	6000	5000	4000	3000	2000	1000	900	800	700	47400
		è¨ˆ	16000	14000	12000	10000	8000	6000	4000	2500	1400	1200	1000	800	80000
	å¹³å‡ä¾¡æ ¼
	ï¼ˆå††ï¼‰	é›Œ	450000	500000	520000	550000	600000	650000	700000	750000	800000	850000	900000	950000	718000
		é›„	580000	630000	660000	700000	750000	800000	850000	900000	950000	1000000	1050000	1100000	847500
		è¨ˆ	520000	570000	600000	640000	710000	750000	800000	850000	900000	950000	1000000	1050000	786667
	å¹³å‡ä½“é‡
	ï¼ˆKgï¼‰	é›Œ	300	305	310	315	320	325	330	335	340	345	350	355	330
		é›„	320	325	330	335	340	345	350	355	360	365	370	375	350
		è¨ˆ	310	315	320	325	330	335	340	345	350	355	360	365	340
	å¹³å‡æ—¥é½¢
	ï¼ˆæ—¥ï¼‰	é›Œ	300	300	300	300	300	300	300	300	300	300	300	300	300
		é›„	290	290	290	290	290	290	290	290	290	290	290	290	290
		è¨ˆ	295	295	295	295	295	295	295	295	295	295	295	295	295
	ï¼‘ãå˜ä¾¡
	ï¼ˆå††ï¼‰	é›Œ	1500	1600	1700	1800	1900	2000	2100	2200	2300	2400	2500	2600	2050
		é›„	1800	1900	2000	2100	2200	2300	2400	2500	2600	2700	2800	2900	2350
		è¨ˆ	1650	1750	1850	1950	2050	2150	2250	2350	2450	2550	2650	2750	2200`;


    // 4. ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
    dataInput.addEventListener('input', debounceProcessData);
    targetYear.addEventListener('input', debounceProcessData);
    targetMonth.addEventListener('input', debounceProcessData);

    // 5. åˆæœŸå‡¦ç†ã®å®Ÿè¡Œ
    // æœ¬æ—¥æ—¥ä»˜ãŒè¨­å®šã•ã‚ŒãŸçŠ¶æ…‹ã§ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†
    processData();
};
</script>
</body>
</html>
